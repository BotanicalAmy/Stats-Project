lead_time_coef <- -0.0117484
# Function to calculate probability of cancellation
cancellation_probability <- function(lead_time) {
logit <- intercept + (lead_time_coef * lead_time)
probability <- 1 / (1 + exp(-logit))
return(probability)
}
# Function to calculate odds of cancellation
cancellation_odds <- function(lead_time) {
prob <- cancellation_probability(lead_time)
odds <- prob / (1 - prob)
return(odds)
}
# Create a sequence of lead times from 0 to 365 days
lead_times <- seq(0, 365, by = 1)
# Calculate probabilities and odds for each lead time
probabilities <- sapply(lead_times, cancellation_probability)
odds <- sapply(lead_times, cancellation_odds)
# Create a data frame for plotting
plot_data <- data.frame(
LeadTime = lead_times,
Probability = probabilities,
Odds = odds
)
# Create visualization
# Set up a 2x1 plotting layout
par(mfrow = c(2, 1), mar = c(4, 4, 0, 2))
# Plot 1: Probability vs Lead Time
plot(plot_data$LeadTime, plot_data$Probability,
type = "l", col = "royalblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Probability of Cancellation",
main = "Probability of Cancellation vs Lead Time",
ylim = c(0, 1))
grid()
# Add reference points
reference_points <- c(0, 30, 60, 90, 180, 365)
reference_probs <- sapply(reference_points, cancellation_probability)
points(reference_points, reference_probs, pch = 19, col = "#FF6B6B")
# Add labels for probability reference points
text(reference_points, reference_probs,
labels = paste0(round(reference_probs*100, 1), "%"),
pos = 3, col = "gray11")
# Plot 2: Odds vs Lead Time
plot(plot_data$LeadTime, plot_data$Odds,
type = "l", col = "midnightblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Odds of Cancellation",
main = "Odds of Cancellation vs Lead Time",
ylim = c(0, 6))
grid()
# Add reference points for odds
reference_odds <- sapply(reference_points, cancellation_odds)
points(reference_points, reference_odds, pch = 19, col = "#FF6B6B")
# Add labels for odds reference points
text(reference_points, reference_odds,
labels = paste0(round(reference_odds, 2)),
pos = 3, col = "gray11")
# Reset plotting parameters
par(mfrow = c(1, 1))
# Additional information: Compare probability and odds changes
reference_table <- data.frame(
LeadTime = reference_points,
Probability = round(reference_probs, 4),
ProbabilityPercentage = paste0(round(reference_probs*100, 1), "%"),
Odds = round(reference_odds, 4)
)
# Print reference table
# print(reference_table)
# Calculate and display odds ratios for different intervals
base_odds <- cancellation_odds(0)
odds_ratios <- sapply(reference_points[-1], function(lt) {
cancellation_odds(lt) / base_odds
})
cat("\nPercentage change in odds from Lead Time = 0:\n")
for (i in 1:length(odds_ratios)) {
pct_change <- (odds_ratios[i] - 1) * 100
cat(sprintf("Lead Time = %d days: %.1f%% change in odds\n",
reference_points[i+1], pct_change))
}
# Calculate and display odds ratio for one-day change
one_day_odds_ratio <- exp(lead_time_coef)
cat(sprintf("\nOdds ratio for one-day increase in lead time: %.4f\n", one_day_odds_ratio))
cat(sprintf("This corresponds to a %.2f%% decrease in odds per day\n",
(1 - one_day_odds_ratio) * 100))
# Parameters from your logistic regression model
intercept <- 1.8046260
lead_time_coef <- -0.0117484
# Function to calculate probability of cancellation
cancellation_probability <- function(lead_time) {
logit <- intercept + (lead_time_coef * lead_time)
probability <- 1 / (1 + exp(-logit))
return(probability)
}
# Function to calculate odds of cancellation
cancellation_odds <- function(lead_time) {
prob <- cancellation_probability(lead_time)
odds <- prob / (1 - prob)
return(odds)
}
# Create a sequence of lead times from 0 to 365 days
lead_times <- seq(0, 365, by = 1)
# Calculate probabilities and odds for each lead time
probabilities <- sapply(lead_times, cancellation_probability)
odds <- sapply(lead_times, cancellation_odds)
# Create a data frame for plotting
plot_data <- data.frame(
LeadTime = lead_times,
Probability = probabilities,
Odds = odds
)
# Create visualization
# Set up a 2x1 plotting layout
par(mfrow = c(2, 1), mar = c(4, 4, 0, 2))
# Plot 1: Probability vs Lead Time
plot(plot_data$LeadTime, plot_data$Probability,
type = "l", col = "royalblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Probability of Cancellation",
title = "Probability of Cancellation vs Lead Time",
ylim = c(0, 1))
grid()
# Add reference points
reference_points <- c(0, 30, 60, 90, 180, 365)
reference_probs <- sapply(reference_points, cancellation_probability)
points(reference_points, reference_probs, pch = 19, col = "#FF6B6B")
# Add labels for probability reference points
text(reference_points, reference_probs,
labels = paste0(round(reference_probs*100, 1), "%"),
pos = 3, col = "gray11")
# Plot 2: Odds vs Lead Time
plot(plot_data$LeadTime, plot_data$Odds,
type = "l", col = "midnightblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Odds of Cancellation",
main = "Odds of Cancellation vs Lead Time",
ylim = c(0, 6))
grid()
# Add reference points for odds
reference_odds <- sapply(reference_points, cancellation_odds)
points(reference_points, reference_odds, pch = 19, col = "#FF6B6B")
# Add labels for odds reference points
text(reference_points, reference_odds,
labels = paste0(round(reference_odds, 2)),
pos = 3, col = "gray11")
# Reset plotting parameters
par(mfrow = c(1, 1))
# Additional information: Compare probability and odds changes
reference_table <- data.frame(
LeadTime = reference_points,
Probability = round(reference_probs, 4),
ProbabilityPercentage = paste0(round(reference_probs*100, 1), "%"),
Odds = round(reference_odds, 4)
)
# Print reference table
# print(reference_table)
# Calculate and display odds ratios for different intervals
base_odds <- cancellation_odds(0)
odds_ratios <- sapply(reference_points[-1], function(lt) {
cancellation_odds(lt) / base_odds
})
cat("\nPercentage change in odds from Lead Time = 0:\n")
for (i in 1:length(odds_ratios)) {
pct_change <- (odds_ratios[i] - 1) * 100
cat(sprintf("Lead Time = %d days: %.1f%% change in odds\n",
reference_points[i+1], pct_change))
}
# Calculate and display odds ratio for one-day change
one_day_odds_ratio <- exp(lead_time_coef)
cat(sprintf("\nOdds ratio for one-day increase in lead time: %.4f\n", one_day_odds_ratio))
cat(sprintf("This corresponds to a %.2f%% decrease in odds per day\n",
(1 - one_day_odds_ratio) * 100))
# Parameters from your logistic regression model
intercept <- 1.8046260
lead_time_coef <- -0.0117484
# Function to calculate probability of cancellation
cancellation_probability <- function(lead_time) {
logit <- intercept + (lead_time_coef * lead_time)
probability <- 1 / (1 + exp(-logit))
return(probability)
}
# Function to calculate odds of cancellation
cancellation_odds <- function(lead_time) {
prob <- cancellation_probability(lead_time)
odds <- prob / (1 - prob)
return(odds)
}
# Create a sequence of lead times from 0 to 365 days
lead_times <- seq(0, 365, by = 1)
# Calculate probabilities and odds for each lead time
probabilities <- sapply(lead_times, cancellation_probability)
odds <- sapply(lead_times, cancellation_odds)
# Create a data frame for plotting
plot_data <- data.frame(
LeadTime = lead_times,
Probability = probabilities,
Odds = odds
)
# Create visualization
# Set up a 2x1 plotting layout
par(mfrow = c(2, 1), mar = c(4, 4, 0, 2))
# Plot 1: Probability vs Lead Time
plot(plot_data$LeadTime, plot_data$Probability,
type = "l", col = "royalblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Probability of Cancellation",
main = "Probability of Cancellation vs Lead Time",
ylim = c(0, 1))
grid()
# Add reference points
reference_points <- c(0, 30, 60, 90, 180, 365)
reference_probs <- sapply(reference_points, cancellation_probability)
points(reference_points, reference_probs, pch = 19, col = "#FF6B6B")
# Add labels for probability reference points
text(reference_points, reference_probs,
labels = paste0(round(reference_probs*100, 1), "%"),
pos = 3, col = "gray11")
# Plot 2: Odds vs Lead Time
plot(plot_data$LeadTime, plot_data$Odds,
type = "l", col = "midnightblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Odds of Cancellation",
main = "Odds of Cancellation vs Lead Time",
ylim = c(0, 6))
grid()
# Add reference points for odds
reference_odds <- sapply(reference_points, cancellation_odds)
points(reference_points, reference_odds, pch = 19, col = "#FF6B6B")
# Add labels for odds reference points
text(reference_points, reference_odds,
labels = paste0(round(reference_odds, 2)),
pos = 3, col = "gray11")
# Reset plotting parameters
par(mfrow = c(1, 1))
# Additional information: Compare probability and odds changes
reference_table <- data.frame(
LeadTime = reference_points,
Probability = round(reference_probs, 4),
ProbabilityPercentage = paste0(round(reference_probs*100, 1), "%"),
Odds = round(reference_odds, 4)
)
# Print reference table
# print(reference_table)
# Calculate and display odds ratios for different intervals
base_odds <- cancellation_odds(0)
odds_ratios <- sapply(reference_points[-1], function(lt) {
cancellation_odds(lt) / base_odds
})
cat("\nPercentage change in odds from Lead Time = 0:\n")
for (i in 1:length(odds_ratios)) {
pct_change <- (odds_ratios[i] - 1) * 100
cat(sprintf("Lead Time = %d days: %.1f%% change in odds\n",
reference_points[i+1], pct_change))
}
# Calculate and display odds ratio for one-day change
one_day_odds_ratio <- exp(lead_time_coef)
cat(sprintf("\nOdds ratio for one-day increase in lead time: %.4f\n", one_day_odds_ratio))
cat(sprintf("This corresponds to a %.2f%% decrease in odds per day\n",
(1 - one_day_odds_ratio) * 100))
# Parameters from your logistic regression model
intercept <- 1.8046260
lead_time_coef <- -0.0117484
# Function to calculate probability of cancellation
cancellation_probability <- function(lead_time) {
logit <- intercept + (lead_time_coef * lead_time)
probability <- 1 / (1 + exp(-logit))
return(probability)
}
# Function to calculate odds of cancellation
cancellation_odds <- function(lead_time) {
prob <- cancellation_probability(lead_time)
odds <- prob / (1 - prob)
return(odds)
}
# Create a sequence of lead times from 0 to 365 days
lead_times <- seq(0, 365, by = 1)
# Calculate probabilities and odds for each lead time
probabilities <- sapply(lead_times, cancellation_probability)
odds <- sapply(lead_times, cancellation_odds)
# Create a data frame for plotting
plot_data <- data.frame(
LeadTime = lead_times,
Probability = probabilities,
Odds = odds
)
# Create visualization
# Set up a 2x1 plotting layout
par(mfrow = c(2, 1), mar = c(4, 4, 0, 2))
# Plot 1: Probability vs Lead Time
plot(plot_data$LeadTime, plot_data$Probability,
type = "l", col = "royalblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Probability of Cancellation",
main = NULL,  # Remove internal title
ylim = c(0, 1))
grid()
# Add title above the plot using mtext
mtext("Probability of Cancellation vs Lead Time", side = 3, line = 1, cex = 1.2, font = 2)
# Add reference points
reference_points <- c(0, 30, 60, 90, 180, 365)
reference_probs <- sapply(reference_points, cancellation_probability)
points(reference_points, reference_probs, pch = 19, col = "#FF6B6B")
# Add labels for probability reference points
text(reference_points, reference_probs,
labels = paste0(round(reference_probs*100, 1), "%"),
pos = 3, col = "gray11")
# Plot 2: Odds vs Lead Time
plot(plot_data$LeadTime, plot_data$Odds,
type = "l", col = "midnightblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Odds of Cancellation",
main = "Odds of Cancellation vs Lead Time",
ylim = c(0, 6))
grid()
# Add reference points for odds
reference_odds <- sapply(reference_points, cancellation_odds)
points(reference_points, reference_odds, pch = 19, col = "#FF6B6B")
# Add labels for odds reference points
text(reference_points, reference_odds,
labels = paste0(round(reference_odds, 2)),
pos = 3, col = "gray11")
# Reset plotting parameters
par(mfrow = c(1, 1))
# Additional information: Compare probability and odds changes
reference_table <- data.frame(
LeadTime = reference_points,
Probability = round(reference_probs, 4),
ProbabilityPercentage = paste0(round(reference_probs*100, 1), "%"),
Odds = round(reference_odds, 4)
)
# Print reference table
# print(reference_table)
# Calculate and display odds ratios for different intervals
base_odds <- cancellation_odds(0)
odds_ratios <- sapply(reference_points[-1], function(lt) {
cancellation_odds(lt) / base_odds
})
cat("\nPercentage change in odds from Lead Time = 0:\n")
for (i in 1:length(odds_ratios)) {
pct_change <- (odds_ratios[i] - 1) * 100
cat(sprintf("Lead Time = %d days: %.1f%% change in odds\n",
reference_points[i+1], pct_change))
}
# Calculate and display odds ratio for one-day change
one_day_odds_ratio <- exp(lead_time_coef)
cat(sprintf("\nOdds ratio for one-day increase in lead time: %.4f\n", one_day_odds_ratio))
cat(sprintf("This corresponds to a %.2f%% decrease in odds per day\n",
(1 - one_day_odds_ratio) * 100))
# Parameters from your logistic regression model
intercept <- 1.8046260
lead_time_coef <- -0.0117484
# Function to calculate probability of cancellation
cancellation_probability <- function(lead_time) {
logit <- intercept + (lead_time_coef * lead_time)
probability <- 1 / (1 + exp(-logit))
return(probability)
}
# Function to calculate odds of cancellation
cancellation_odds <- function(lead_time) {
prob <- cancellation_probability(lead_time)
odds <- prob / (1 - prob)
return(odds)
}
# Create a sequence of lead times from 0 to 365 days
lead_times <- seq(0, 365, by = 1)
# Calculate probabilities and odds for each lead time
probabilities <- sapply(lead_times, cancellation_probability)
odds <- sapply(lead_times, cancellation_odds)
# Create a data frame for plotting
plot_data <- data.frame(
LeadTime = lead_times,
Probability = probabilities,
Odds = odds
)
# Create visualization
# Set up a 2x1 plotting layout
par(mfrow = c(2, 1), mar = c(4, 4, 0, 2))
# Plot 1: Probability vs Lead Time
plot(plot_data$LeadTime, plot_data$Probability,
type = "l", col = "royalblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Probability of Cancellation",
main = NULL,  # Remove internal title
ylim = c(0, 1))
grid()
# Add title above the plot using mtext
mtext("Probability of Cancellation vs Lead Time", side = 3, line = 2.5, cex = 1.5, font = 2, col = "black", adj = 0.5)
# Add reference points
reference_points <- c(0, 30, 60, 90, 180, 365)
reference_probs <- sapply(reference_points, cancellation_probability)
points(reference_points, reference_probs, pch = 19, col = "#FF6B6B")
# Add labels for probability reference points
text(reference_points, reference_probs,
labels = paste0(round(reference_probs*100, 1), "%"),
pos = 3, col = "gray11")
# Plot 2: Odds vs Lead Time
plot(plot_data$LeadTime, plot_data$Odds,
type = "l", col = "midnightblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Odds of Cancellation",
main = "Odds of Cancellation vs Lead Time",
ylim = c(0, 6))
grid()
# Add reference points for odds
reference_odds <- sapply(reference_points, cancellation_odds)
points(reference_points, reference_odds, pch = 19, col = "#FF6B6B")
# Add labels for odds reference points
text(reference_points, reference_odds,
labels = paste0(round(reference_odds, 2)),
pos = 3, col = "gray11")
# Reset plotting parameters
par(mfrow = c(1, 1))
# Additional information: Compare probability and odds changes
reference_table <- data.frame(
LeadTime = reference_points,
Probability = round(reference_probs, 4),
ProbabilityPercentage = paste0(round(reference_probs*100, 1), "%"),
Odds = round(reference_odds, 4)
)
# Print reference table
# print(reference_table)
# Calculate and display odds ratios for different intervals
base_odds <- cancellation_odds(0)
odds_ratios <- sapply(reference_points[-1], function(lt) {
cancellation_odds(lt) / base_odds
})
cat("\nPercentage change in odds from Lead Time = 0:\n")
for (i in 1:length(odds_ratios)) {
pct_change <- (odds_ratios[i] - 1) * 100
cat(sprintf("Lead Time = %d days: %.1f%% change in odds\n",
reference_points[i+1], pct_change))
}
# Calculate and display odds ratio for one-day change
one_day_odds_ratio <- exp(lead_time_coef)
cat(sprintf("\nOdds ratio for one-day increase in lead time: %.4f\n", one_day_odds_ratio))
cat(sprintf("This corresponds to a %.2f%% decrease in odds per day\n",
(1 - one_day_odds_ratio) * 100))
# Parameters from your logistic regression model
intercept <- 1.8046260
lead_time_coef <- -0.0117484
# Function to calculate probability of cancellation
cancellation_probability <- function(lead_time) {
logit <- intercept + (lead_time_coef * lead_time)
probability <- 1 / (1 + exp(-logit))
return(probability)
}
# Function to calculate odds of cancellation
cancellation_odds <- function(lead_time) {
prob <- cancellation_probability(lead_time)
odds <- prob / (1 - prob)
return(odds)
}
# Create a sequence of lead times from 0 to 365 days
lead_times <- seq(0, 365, by = 1)
# Calculate probabilities and odds for each lead time
probabilities <- sapply(lead_times, cancellation_probability)
odds <- sapply(lead_times, cancellation_odds)
# Create a data frame for plotting
plot_data <- data.frame(
LeadTime = lead_times,
Probability = probabilities,
Odds = odds
)
# Create visualization
# Set up a 2x1 plotting layout
par(mfrow = c(2, 1), mar = c(4, 4, 2, 2))
# Plot 1: Probability vs Lead Time
plot(plot_data$LeadTime, plot_data$Probability,
type = "l", col = "royalblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Probability of Cancellation",
main = "Probability of Cancellation vs Lead Time",
ylim = c(0, 1))
grid()
# Add reference points
reference_points <- c(0, 30, 60, 90, 180, 365)
reference_probs <- sapply(reference_points, cancellation_probability)
points(reference_points, reference_probs, pch = 19, col = "#FF6B6B")
# Add labels for probability reference points
text(reference_points, reference_probs,
labels = paste0(round(reference_probs*100, 1), "%"),
pos = 3, col = "gray11")
# Plot 2: Odds vs Lead Time
plot(plot_data$LeadTime, plot_data$Odds,
type = "l", col = "midnightblue", lwd = 2,
xlab = "Lead Time (days)", ylab = "Odds of Cancellation",
main = "Odds of Cancellation vs Lead Time",
ylim = c(0, 6))
grid()
# Add reference points for odds
reference_odds <- sapply(reference_points, cancellation_odds)
points(reference_points, reference_odds, pch = 19, col = "#FF6B6B")
# Add labels for odds reference points
text(reference_points, reference_odds,
labels = paste0(round(reference_odds, 2)),
pos = 3, col = "gray11")
# Reset plotting parameters
par(mfrow = c(1, 1))
# Additional information: Compare probability and odds changes
reference_table <- data.frame(
LeadTime = reference_points,
Probability = round(reference_probs, 4),
ProbabilityPercentage = paste0(round(reference_probs*100, 1), "%"),
Odds = round(reference_odds, 4)
)
# Print reference table
# print(reference_table)
# Calculate and display odds ratios for different intervals
base_odds <- cancellation_odds(0)
odds_ratios <- sapply(reference_points[-1], function(lt) {
cancellation_odds(lt) / base_odds
})
cat("\nPercentage change in odds from Lead Time = 0:\n")
for (i in 1:length(odds_ratios)) {
pct_change <- (odds_ratios[i] - 1) * 100
cat(sprintf("Lead Time = %d days: %.1f%% change in odds\n",
reference_points[i+1], pct_change))
}
# Calculate and display odds ratio for one-day change
one_day_odds_ratio <- exp(lead_time_coef)
cat(sprintf("\nOdds ratio for one-day increase in lead time: %.4f\n", one_day_odds_ratio))
cat(sprintf("This corresponds to a %.2f%% decrease in odds per day\n",
(1 - one_day_odds_ratio) * 100))
